!function(n){function e(e,o,t,i,s,r){var c=n(o).data("img-src");void 0!=c&&c>""&&(e=n(e),text=n(o).text(),s=void 0==s||s,r=r||(s?"chose-image":"chose-image-small"),r=i?r+" rtl":r,t=t.replace("{url}",c).replace("{class_name}",r).replace("{text}",text),e.empty(),i&&s?e.append(t):e.prepend(t))}var o='<img class="{class_name}" src="{url}" />',t=n.fn.chosen;n.fn.extend({chosen:function(i){i=i||{};t.apply(this,arguments);return this.each(function(){var t=n(this),s=t.data("chosen");t.on("chosen:hiding_dropdown",function(t,s){for(var r=function(e){for(var o=[],t=n(e.form_field).find("option:selected")||[],i=e.is_multiple?n(e.container).find(".chosen-choices span"):n(e.container).find(".chosen-single span"),s=0;s<t.length;s++)for(var r=0;r<i.length;r++)n(i[r]).text()==n(t[s]).text()&&o.push({span:i[r],option:t[s]});return o}(s.chosen),c=s.chosen.is_rtl,a=s.chosen.is_multiple,h=i.html_template||(c&&a?"{text}"+o:o+"{text}"),d=0;d<r.length;d++)e(r[d].span,r[d].option,h,c,a)}),t.on("chosen:showing_dropdown",function(t,s){for(var r=(s=s.chosen).form_field.options||[],c=s.is_rtl,a=i.html_template||(c?"{text}"+o:o+"{text}"),h=n(s.container).find(".chosen-drop ul li:not(:has(img))"),d=0;d<h.length;d++){var l=h[d],p=(n(r[d]),n(l).attr("data-option-array-index"));p&&e(l,r[s.results_data[p].options_index],a,c,!0,"chose-image-list")}}),t.on("chosen:ready",function(n,e){t.trigger("chosen:hiding_dropdown",e)}),t.on("chosen:updated",function(n){t.trigger("chosen:hiding_dropdown",{chosen:s})}),t.on("chosen:filter",function(n,e){t.trigger("chosen:showing_dropdown",{chosen:e.chosen})}),void 0!==s&&t.trigger("chosen:hiding_dropdown",{chosen:s})}),n(this)}})}(jQuery);